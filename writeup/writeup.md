# The HackArmour Malware Challenge Writup

The zip contains malware executable and a readme.txt with some instructions. The malware will only affect the `affected_folder` so dont take it out of that directory. Let's run it:

![malware test run](./test.png)

Now if you open the txt files, any information which was present there wont be found and rather they are spammed by some "sus" text. Do not close the terminal or the program. If you try to give any flag, it will ask you infinitely until you supply the correct one hence we have unlimited chances.

Let's open the binary in ghidra and keep the analysis settings to default. It will take some time to analyze it has the binary is big. Let's take a look at the functions list:

![functions](./functions.png)

### Finding the actual `main`
The main function is where the program starts but as this malware is written in rust, we will have to dig deeper to find the actual implemented code. Let's look at the disassembly of `entry` as that is what runs first this time.

![entry](./entryFunc.png)

After checking all the functions it calls, I could identify that the third function `FUN_0016ab20` has a call to another function. Lets look at the disassembly of this func:
![main_call](./main_call.png)

